# lvgl.yaml
lvgl:
  id: lvgl_main
  display: my_display
  touchscreen: my_touch
  
  # Styles
  styles:
    - id: roboto15_style
      text_font: roboto15_font
      text_color: 0xFFFFFF
      
    - id: roboto36_style
      text_font: roboto36_font
      text_color: 0xFFFFFF
      
    - id: footer_button_style
      radius: 8
      bg_color: 0x2B6CB0
      border_width: 0
      
    - id: control_button_style
      radius: 12
      bg_color: 0x4A5568
      bg_color_checked: 0x2B6CB0
      border_width: 2
      border_color: 0x718096

  # Top Layer (immer sichtbar)
  top_layer:
    widgets:
      - label:
          id: temperatures
          text: "-¬∞ / -¬∞"
          styles: roboto15_style
          align: top_left
          x: 8
          y: 4
          
      - label:
          id: display_time
          text: "--:--"
          styles: roboto15_style  
          align: top_mid
          x: 0
          y: 4
          text_align: center
          
      - label:
          id: wifi_icon_label
          text: "üì∂"
          styles: roboto15_style
          text_font: icon_font_header
          align: top_right
          x: -8
          y: 4
          
      - label:
          id: lbl_hastatus
          text: "$wifi_off"
          styles: roboto15_style
          align: top_right
          x: -40
          y: 4

      # Footer Navigation
      - obj:
          id: page_footer
          align: bottom_mid
          width: 100%
          height: 22px
          bg_opa: 0
          border_width: 0
          pad_all: 2px
          layout:
            type: flex
            flex_flow: row
            flex_align_main: space_between
            flex_align_cross: center
          widgets:
            - button:
                id: footer_prev_button
                styles: footer_button_style
                width: 60px
                height: 20px
                widgets:
                  - label:
                      text_font: icon_font_header
                      text_color: 0xFFFFFF
                      text: "‚Üê"
                      align: center
                on_click:
                  - lvgl.page.previous:
                      animation: MOVE_RIGHT
                      time: 300ms
                      
            - button:
                id: footer_home_button
                styles: footer_button_style
                width: 60px
                height: 20px
                widgets:
                  - label:
                      text_font: icon_font_header  
                      text_color: 0xFFFFFF
                      text: "‚åÇ"
                      align: center
                on_click:
                  - lvgl.page.show: weather_page
                  
            - button:
                id: footer_next_button
                styles: footer_button_style
                width: 60px
                height: 20px
                widgets:
                  - label:
                      text_font: icon_font_header
                      text_color: 0xFFFFFF
                      text: "‚Üí"
                      align: center
                on_click:
                  - lvgl.page.next:
                      animation: MOVE_LEFT  
                      time: 300ms

  # Seiten definieren
  pages:
    # Wetter Seite
    - id: weather_page
      width: 100%
      bg_color: 0
      bg_opa: cover
      pad_top: 30px
      pad_bottom: 26px
      pad_left: 5px
      pad_right: 5px
      bg_image_src: background
      bg_image_opa: cover
      bg_image_tiled: false
      widgets:
        # Datum & Zeit
        - label:
            id: weekday_label
            align: top_right
            x: -33
            y: 10
            width: 350
            text_align: right
            styles: roboto36_style
            text: !lambda |-
              static const char* weekdays[] = {"Sonntag", "Montag", "Dienstag", "Mittwoch", "Donnerstag", "Freitag", "Samstag"};
              auto now = id(sntp_time).now();
              return now.is_valid() ? weekdays[now.day_of_week - 1] : "Unbekannt";
              
        - label:
            id: date_label
            align: top_right
            x: -33
            y: 50
            width: 350
            text_align: right
            styles: roboto36_style
            text: !lambda |-
              static const char* months[] = {"Jan", "Feb", "M√§r", "Apr", "Mai", "Jun", "Jul", "Aug", "Sep", "Okt", "Nov", "Dez"};
              auto now = id(sntp_time).now();
              if (now.is_valid()) {
                char date_buf[30];
                snprintf(date_buf, sizeof(date_buf), "%02d. %s %d", now.day_of_month, months[now.month - 1], now.year);
                return std::string(date_buf);
              }
              return "--.--.----";
              
        - label:
            id: time_label
            align: top_right
            x: -33
            y: 90
            width: 350
            text_align: right
            styles: roboto36_style
            text: !lambda |-
              static char time_buf[6];
              auto now = id(sntp_time).now();
              if (now.is_valid()) {
                snprintf(time_buf, sizeof(time_buf), "%02d:%02d", now.hour, now.minute);
                return time_buf;
              }
              return "--:--";

        # Au√üentemperatur
        - image:
            id: outdoor_temp_png_icon
            x: 28
            y: 10
            width: 100
            height: 100
            src: icon_png_outdoor_temp
            
        - label:
            id: outdoor_temp_large_label
            x: 138
            y: 42
            styles: roboto36_style
            text: " "

        # Wetter
        - image:
            id: lvgl_weather_image_widget
            x: 28
            y: 114
            width: 100
            height: 100
            src: icon_png_sunny
            
        - label:
            id: weather_description
            x: 138
            y: 146
            styles: roboto36_style
            text: " "

        # Flur Temperatur
        - image:
            id: flur_temp_png_icon
            x: 28
            y: 218
            width: 100
            height: 100
            src: icon_png_indoor_temp
            
        - label:
            id: flur_temp_value_label
            x: 138
            y: 250
            styles: roboto36_style
            text: " "

        # Flur Luftfeuchtigkeit
        - image:
            id: flur_humidity_png_icon
            x: 28
            y: 322
            width: 100
            height: 100
            src: icon_png_humidity
            
        - label:
            id: flur_humidity_value_label
            x: 138
            y: 354
            styles: roboto36_style
            text: " "

    # Hauptseite mit Steuerung
    - id: main_page
      width: 100%
      bg_color: 0
      bg_opa: cover
      pad_top: 30px
      pad_bottom: 26px
      pad_left: 5px
      pad_right: 5px
      layout:
        type: grid
        grid_columns: [FR(1), FR(1), FR(1), FR(1), FR(1)]
        grid_rows: [CONTENT, CONTENT, CONTENT, CONTENT]
        grid_align_main: start
        grid_align_cross: start
      widgets:
        # Zeile 1
        - button:
            grid_cell_column_pos: 0
            grid_cell_row_pos: 0
            height: 100px
            checkable: true
            id: wz_lichtschalter_button
            styles: control_button_style
            widgets:
              - label:
                  text_font: icon_font
                  align: top_left
                  id: wz_lichtschalter_icon
                  text: "üí°"
              - label:
                  text_font: roboto15_font
                  align: bottom_left
                  id: wz_lichtschalter_label
                  text: "Wohnzimmer"
            on_click:
              - homeassistant.service:
                  service: light.toggle
                  data:
                    entity_id: light.wz_lichtschalter
                    
        - button:
            grid_cell_column_pos: 1
            grid_cell_row_pos: 0
            height: 100px
            checkable: true
            styles: control_button_style
            id: esszimmertisch_button
            widgets:
              - label:
                  text_font: icon_font
                  align: top_left
                  id: esszimmertisch_icon
                  text: "üí°"
              - label:
                  text_font: roboto15_font
                  align: bottom_left
                  id: esszimmertisch_label
                  text: "Esszimmer Tisch"
            on_click:
              - homeassistant.service:
                  service: light.toggle
                  data:
                    entity_id: light.esszimmer_esstisch
                    
        - button:
            grid_cell_column_pos: 2
            grid_cell_row_pos: 0
            height: 100px
            checkable: true
            id: apple_tv_button
            styles: control_button_style
            widgets:
              - image:
                  id: apple_tv_icon
                  src: apple_tv_off
                  align: top_left
                  x: 5
                  y: 5
              - label:
                  text_font: roboto15_font
                  align: bottom_left
                  id: apple_tv_label
                  text: "Apple TV"
            on_click:
              - homeassistant.service:
                  service: switch.toggle
                  data:
                    entity_id: switch.apple_tv_an
                    
        - button:
            grid_cell_column_pos: 4
            grid_cell_row_pos: 0
            height: 100px
            checkable: true
            id: wz_blinds_toggle_button
            styles: control_button_style
            widgets:
              - label:
                  text_font: icon_font
                  align: top_left
                  id: wz_blinds_toggle_icon
                  text: "ü™ü"
              - label:
                  text_font: roboto15_font
                  align: bottom_left
                  id: wz_blinds_toggle_label
                  text: "Jalousien"
            on_click:
              - homeassistant.service:
                  service: cover.toggle
                  data:
                    entity_id:
                      - cover.wohnzimmer_links
                      - cover.wohnzimmer_rechts
                      - cover.esszimmer_links
                      - cover.esszimmer_rechts

        # Zeile 2
        - button:
            grid_cell_column_pos: 0
            grid_cell_row_pos: 1
            id: wohnzimmer_stehlampe_button
            height: 100px
            checkable: true
            styles: control_button_style
            widgets:
              - label:
                  text_font: icon_font
                  align: top_left
                  id: wohnzimmer_stehlampe_icon
                  text: "üí°"
              - label:
                  text_font: roboto15_font
                  align: bottom_left
                  id: wohnzimmer_stehlampe_label
                  text: "Stehlampe"
            on_click:
              - homeassistant.service:
                  service: light.toggle
                  data:
                    entity_id: light.wohnzimmer_stehlampe
                    
        - button:
            grid_cell_column_pos: 1
            grid_cell_row_pos: 1
            height: 100px
            checkable: true
            styles: control_button_style
            id: esszimmer_stehlampe_button
            widgets:
              - label:
                  text_font: icon_font
                  align: top_left
                  id: esszimmer_stehlampe_icon
                  text: "üí°"
              - label:
                  text_font: roboto15_font
                  align: bottom_left
                  id: esszimmer_stehlampe_label
                  text: "Stehlampe"
            on_click:
              - homeassistant.service:
                  service: light.toggle
                  data:
                    entity_id: light.esszimmer_stehlampe

        # Zeile 3
        - button:
            grid_cell_column_pos: 0
            grid_cell_row_pos: 2
            height: 100px
            checkable: true
            styles: control_button_style
            id: wohnzimmer_deckenlampe_button
            widgets:
              - label:
                  text_font: icon_font
                  align: top_left
                  id: wohnzimmer_deckenlampe_icon
                  text: "üí°"
              - label:
                  text_font: roboto15_font
                  align: bottom_left
                  id: wohnzimmer_deckenlampe_label
                  text: "Deckenlampe"
            on_click:
              - homeassistant.service:
                  service: light.toggle
                  data:
                    entity_id: light.wohnzimmer_deckenlampe
                    
        - button:
            grid_cell_column_pos: 1
            grid_cell_row_pos: 2
            height: 100px
            checkable: true
            styles: control_button_style
            id: esszimmer_kugellampe_button
            widgets:
              - label:
                  text_font: icon_font
                  align: top_left
                  id: esszimmer_kugellampe_icon
                  text: "üí°"
              - label:
                  text_font: roboto15_font
                  align: bottom_left
                  id: esszimmer_kugellampe_label
                  text: "Kugellampe"
            on_click:
              - homeassistant.service:
                  service: light.toggle
                  data:
                    entity_id: light.esszimmer_kugellampe

        # Zeile 4
        - button:
            grid_cell_column_pos: 0
            grid_cell_row_pos: 3
            height: 100px
            checkable: true
            id: sideboard_button
            styles: control_button_style
            widgets:
              - label:
                  text_font: icon_font
                  align: top_left
                  id: sideboard_icon
                  text: "üí°"
              - label:
                  text_font: roboto15_font
                  align: bottom_left
                  id: sideboard_label
                  text: "Sideboard"
            on_click:
              - homeassistant.service:
                  service: light.toggle
                  data:
                    entity_id: light.shapes_8363
                    
        - button:
            grid_cell_column_pos: 1
            grid_cell_row_pos: 3
            height: 100px
            checkable: true
            styles: control_button_style
            id: nische_button
            widgets:
              - label:
                  text_font: icon_font
                  align: top_left
                  id: nische_icon
                  text: "üí°"
              - label:
                  text_font: roboto15_font
                  align: bottom_left
                  id: nische_label
                  text: "Nische"
            on_click:
              - homeassistant.service:
                  service: light.toggle
                  data:
                    entity_id: light.esszimmer_nische
